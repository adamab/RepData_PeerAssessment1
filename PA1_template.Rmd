---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
First I unzip the data using the unzip function. Then load the activity data from your current working directory using read.csv. The data will be assigned to variable activity.data.

```{r unzip, echo = TRUE, results = "hide"}
unzip("./activity.zip")
activity.data <- read.csv("./activity.csv", colClasses = c("numeric", "character", "numeric"))
```

Then I change the date to the Posixlt format for ease of use later in the analysis.

```{r updatedate, echo = TRUE, results = "hide"}
unzip("./activity.zip")
activity.data$date <- as.POSIXlt(activity.data$date)
```

## What is mean total number of steps taken per day?
In order to determine the sum of steps each day I use the tapply function and assign it to sum.day.

```{r sumday, echo = TRUE, results = "hide"}
sum.day <- tapply(activity.data$steps, as.POSIXct(activity.data$date), sum, na.rm = TRUE)
```

Now I will generate the histogram to show the distribution of total daily steps.

```{r sumhisto, echo = TRUE, fig.height = 4}
hist(sum.day, main = "Histogram - Total Daily Steps", xlab = "Total Daily Steps")
```

```{r sumday, echo = TRUE, results = "hide"}
sum.mean <- mean(sum.day)
sum.median <- median(sum.day)
```

The mean of total daily steps is: `r sum.mean`, and the median is: `r sum.median`.

## What is the average daily activity pattern?
I will now generate the average daily steps for each 5 minute interval.

```{r intervalaverage, echo = TRUE, results = "hide"}
sum.interval <- tapply(activity.data$steps, activity.data$interval, mean, na.rm = TRUE)
```

This is a time series of the results from the above computation.

```{r timeseries, echo = TRUE, fig.height = 4}
plot(sum.interval, type = "l", xlab = "Interval", ylab = "Average Daily Steps", main = "Average Daily Steps Time Series")
```

```{r intervalaverage, echo = TRUE, results = "hide"}
max.interval <- max(sum.interval)
interval.max <- as.numeric(names(sum.interval[sum.interval = max.interval]))
```
There is an interesting peak in the time series. Let's see what the value is, and for which interval it is.  

The value is `r max.interval` for interval `r interval.max`.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
